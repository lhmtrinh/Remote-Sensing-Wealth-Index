regression with resnet 24 channels, RGB channels are NOT scaled to imagenet
loss function is modified to tackle imbalance structure
Use Huber Loss

from model import load_resnet_model
from train_regression_weighted_loss import train_model
from weighted_MSE_loss import DenseWeight


device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = load_resnet_model('resnet50', num_classes=1)

dense_weight_model = DenseWeight(0.2)

100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
100%|██████████| 8/8 [00:02<00:00,  3.61it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 4/4 [00:01<00:00,  3.63it/s]
100%|██████████| 8/8 [00:01<00:00,  7.33it/s]
100%|██████████| 8/8 [00:01<00:00,  6.10it/s]
100%|██████████| 8/8 [00:01<00:00,  7.02it/s]
100%|██████████| 8/8 [00:01<00:00,  7.26it/s]
100%|██████████| 3/3 [00:00<00:00,  8.02it/s]
Epoch 1/15, Train Loss: 0.1247, Train R2: -0.4958, Val Loss: 0.1439, Val R2: -0.3785
Model saved as checkpoint_epoch_1.pth
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 4/4 [00:01<00:00,  3.72it/s]
100%|██████████| 8/8 [00:01<00:00,  7.17it/s]
100%|██████████| 8/8 [00:01<00:00,  7.14it/s]
100%|██████████| 8/8 [00:01<00:00,  6.94it/s]
100%|██████████| 8/8 [00:01<00:00,  6.90it/s]
100%|██████████| 3/3 [00:00<00:00,  9.97it/s]
Epoch 2/15, Train Loss: 0.0655, Train R2: 0.3688, Val Loss: 0.0725, Val R2: 0.3238
Model saved as checkpoint_epoch_2.pth
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.61it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 4/4 [00:01<00:00,  3.73it/s]
100%|██████████| 8/8 [00:01<00:00,  7.16it/s]
100%|██████████| 8/8 [00:01<00:00,  7.20it/s]
100%|██████████| 8/8 [00:01<00:00,  7.09it/s]
100%|██████████| 8/8 [00:01<00:00,  7.20it/s]
100%|██████████| 3/3 [00:00<00:00,  9.97it/s]
Epoch 3/15, Train Loss: 0.0557, Train R2: 0.4631, Val Loss: 0.0590, Val R2: 0.4453
Model saved as checkpoint_epoch_3.pth
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.20it/s]
100%|██████████| 8/8 [00:01<00:00,  7.19it/s]
100%|██████████| 8/8 [00:01<00:00,  6.95it/s]
100%|██████████| 8/8 [00:01<00:00,  6.92it/s]
100%|██████████| 3/3 [00:00<00:00, 10.01it/s]
Epoch 4/15, Train Loss: 0.0506, Train R2: 0.5123, Val Loss: 0.0555, Val R2: 0.4574
Model saved as checkpoint_epoch_4.pth
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 4/4 [00:01<00:00,  3.72it/s]
100%|██████████| 8/8 [00:01<00:00,  7.18it/s]
100%|██████████| 8/8 [00:01<00:00,  6.98it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 3/3 [00:00<00:00,  9.93it/s]
Epoch 5/15, Train Loss: 0.0489, Train R2: 0.5270, Val Loss: 0.0487, Val R2: 0.5392
Model saved as checkpoint_epoch_5.pth
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  6.86it/s]
100%|██████████| 8/8 [00:01<00:00,  7.11it/s]
100%|██████████| 8/8 [00:01<00:00,  6.99it/s]
100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
100%|██████████| 3/3 [00:00<00:00,  9.80it/s]
Epoch 6/15, Train Loss: 0.0503, Train R2: 0.5139, Val Loss: 0.0863, Val R2: 0.1822
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.70it/s]
100%|██████████| 8/8 [00:01<00:00,  7.08it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.86it/s]
100%|██████████| 8/8 [00:01<00:00,  6.87it/s]
100%|██████████| 3/3 [00:00<00:00,  9.94it/s]
Epoch 7/15, Train Loss: 0.0460, Train R2: 0.5579, Val Loss: 0.0705, Val R2: 0.3369
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.45it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 4/4 [00:01<00:00,  3.68it/s]
100%|██████████| 8/8 [00:01<00:00,  7.13it/s]
100%|██████████| 8/8 [00:01<00:00,  6.17it/s]
100%|██████████| 8/8 [00:01<00:00,  7.08it/s]
100%|██████████| 8/8 [00:01<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  9.87it/s]
Epoch 8/15, Train Loss: 0.0443, Train R2: 0.5726, Val Loss: 0.0680, Val R2: 0.3668
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  6.98it/s]
100%|██████████| 8/8 [00:01<00:00,  6.70it/s]
100%|██████████| 8/8 [00:01<00:00,  6.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.09it/s]
100%|██████████| 3/3 [00:00<00:00,  9.90it/s]
Epoch 9/15, Train Loss: 0.0417, Train R2: 0.5973, Val Loss: 0.0562, Val R2: 0.4660
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 4/4 [00:01<00:00,  3.68it/s]
100%|██████████| 8/8 [00:01<00:00,  7.06it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  7.05it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 3/3 [00:00<00:00,  9.90it/s]
Epoch 10/15, Train Loss: 0.0391, Train R2: 0.6223, Val Loss: 0.0579, Val R2: 0.4464
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 4/4 [00:01<00:00,  3.67it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  9.85it/s]
Epoch 11/15, Train Loss: 0.0439, Train R2: 0.5755, Val Loss: 0.0726, Val R2: 0.3195
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.41it/s]
100%|██████████| 8/8 [00:02<00:00,  3.46it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
