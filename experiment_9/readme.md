regression with resnet 24 channels, RGB channels are NOT scaled to imagenet
loss function is modified to tackle imbalance structure

from model import load_resnet_model
from train_regression_weighted_loss import train_model
from weighted_MSE_loss import DenseWeight


device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = load_resnet_model('resnet50', num_classes=1)

dense_weight_model = DenseWeight(0.2)

100%|██████████| 8/8 [00:04<00:00,  1.94it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.61it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 4/4 [00:01<00:00,  3.58it/s]
100%|██████████| 8/8 [00:01<00:00,  7.35it/s]
100%|██████████| 8/8 [00:01<00:00,  7.02it/s]
100%|██████████| 8/8 [00:01<00:00,  7.24it/s]
100%|██████████| 8/8 [00:01<00:00,  7.16it/s]
100%|██████████| 3/3 [00:00<00:00,  7.50it/s]
Epoch 1/15, Train Loss: 0.3109, Train R2: -0.5197, Val Loss: 0.1641, Val R2: 0.2267
Model saved as checkpoint_epoch_1.pth
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.15it/s]
100%|██████████| 8/8 [00:01<00:00,  6.84it/s]
100%|██████████| 8/8 [00:01<00:00,  6.83it/s]
100%|██████████| 8/8 [00:01<00:00,  7.12it/s]
100%|██████████| 3/3 [00:00<00:00,  9.76it/s]
Epoch 2/15, Train Loss: 0.1300, Train R2: 0.3748, Val Loss: 0.1578, Val R2: 0.2635
Model saved as checkpoint_epoch_2.pth
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.43it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 4/4 [00:01<00:00,  3.74it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  7.18it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  7.16it/s]
100%|██████████| 3/3 [00:00<00:00,  9.69it/s]
Epoch 3/15, Train Loss: 0.1174, Train R2: 0.4347, Val Loss: 0.1120, Val R2: 0.4728
Model saved as checkpoint_epoch_3.pth
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.17it/s]
100%|██████████| 8/8 [00:01<00:00,  6.86it/s]
100%|██████████| 8/8 [00:01<00:00,  6.90it/s]
100%|██████████| 8/8 [00:01<00:00,  6.87it/s]
100%|██████████| 3/3 [00:00<00:00, 10.00it/s]
Epoch 4/15, Train Loss: 0.1074, Train R2: 0.4833, Val Loss: 0.1057, Val R2: 0.5030
Model saved as checkpoint_epoch_4.pth
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  6.83it/s]
100%|██████████| 8/8 [00:01<00:00,  7.08it/s]
100%|██████████| 8/8 [00:01<00:00,  7.03it/s]
100%|██████████| 8/8 [00:01<00:00,  6.85it/s]
100%|██████████| 3/3 [00:00<00:00,  9.98it/s]
Epoch 5/15, Train Loss: 0.0973, Train R2: 0.5327, Val Loss: 0.1116, Val R2: 0.4786
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 4/4 [00:01<00:00,  3.74it/s]
100%|██████████| 8/8 [00:01<00:00,  6.81it/s]
100%|██████████| 8/8 [00:01<00:00,  7.16it/s]
100%|██████████| 8/8 [00:01<00:00,  6.80it/s]
100%|██████████| 8/8 [00:01<00:00,  6.94it/s]
100%|██████████| 3/3 [00:00<00:00,  9.91it/s]
Epoch 6/15, Train Loss: 0.1072, Train R2: 0.4853, Val Loss: 0.1049, Val R2: 0.4932
Model saved as checkpoint_epoch_6.pth
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 4/4 [00:01<00:00,  3.70it/s]
100%|██████████| 8/8 [00:01<00:00,  6.90it/s]
100%|██████████| 8/8 [00:01<00:00,  6.84it/s]
100%|██████████| 8/8 [00:01<00:00,  6.90it/s]
100%|██████████| 8/8 [00:01<00:00,  7.12it/s]
100%|██████████| 3/3 [00:00<00:00,  9.97it/s]
Epoch 7/15, Train Loss: 0.0996, Train R2: 0.5222, Val Loss: 0.1240, Val R2: 0.4278
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 4/4 [00:01<00:00,  3.73it/s]
100%|██████████| 8/8 [00:01<00:00,  7.04it/s]
100%|██████████| 8/8 [00:01<00:00,  7.12it/s]
100%|██████████| 8/8 [00:01<00:00,  7.08it/s]
100%|██████████| 8/8 [00:01<00:00,  7.14it/s]
100%|██████████| 3/3 [00:00<00:00,  9.95it/s]
Epoch 8/15, Train Loss: 0.0926, Train R2: 0.5553, Val Loss: 0.1475, Val R2: 0.3228
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.70it/s]
100%|██████████| 8/8 [00:01<00:00,  7.12it/s]
100%|██████████| 8/8 [00:01<00:00,  6.87it/s]
100%|██████████| 8/8 [00:01<00:00,  6.80it/s]
100%|██████████| 8/8 [00:01<00:00,  6.88it/s]
100%|██████████| 3/3 [00:00<00:00,  9.86it/s]
Epoch 9/15, Train Loss: 0.0916, Train R2: 0.5598, Val Loss: 0.0973, Val R2: 0.5410
Model saved as checkpoint_epoch_9.pth
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  6.80it/s]
100%|██████████| 8/8 [00:01<00:00,  6.82it/s]
100%|██████████| 8/8 [00:01<00:00,  7.09it/s]
100%|██████████| 3/3 [00:00<00:00,  9.88it/s]
Epoch 10/15, Train Loss: 0.0903, Train R2: 0.5659, Val Loss: 0.0943, Val R2: 0.5453
Model saved as checkpoint_epoch_10.pth
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.70it/s]
100%|██████████| 8/8 [00:01<00:00,  7.04it/s]
100%|██████████| 8/8 [00:01<00:00,  7.13it/s]
100%|██████████| 8/8 [00:01<00:00,  6.75it/s]
100%|██████████| 8/8 [00:01<00:00,  6.84it/s]
100%|██████████| 3/3 [00:00<00:00,  9.81it/s]
Epoch 11/15, Train Loss: 0.0832, Train R2: 0.6000, Val Loss: 0.0944, Val R2: 0.5533
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  6.83it/s]
100%|██████████| 8/8 [00:01<00:00,  6.85it/s]
100%|██████████| 8/8 [00:01<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  9.94it/s]
Epoch 12/15, Train Loss: 0.0791, Train R2: 0.6195, Val Loss: 0.1065, Val R2: 0.5007
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.68it/s]
100%|██████████| 8/8 [00:01<00:00,  7.06it/s]
100%|██████████| 8/8 [00:01<00:00,  7.01it/s]
100%|██████████| 8/8 [00:01<00:00,  7.03it/s]
100%|██████████| 8/8 [00:01<00:00,  6.75it/s]
100%|██████████| 3/3 [00:00<00:00,  9.85it/s]
Epoch 13/15, Train Loss: 0.0744, Train R2: 0.6418, Val Loss: 0.1015, Val R2: 0.5045
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.00it/s]
100%|██████████| 8/8 [00:01<00:00,  6.82it/s]
100%|██████████| 8/8 [00:01<00:00,  7.05it/s]
100%|██████████| 8/8 [00:01<00:00,  7.09it/s]
100%|██████████| 3/3 [00:00<00:00,  9.96it/s]
Epoch 14/15, Train Loss: 0.0765, Train R2: 0.6312, Val Loss: 0.1236, Val R2: 0.4217
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 4/4 [00:01<00:00,  3.66it/s]
100%|██████████| 8/8 [00:01<00:00,  6.78it/s]
100%|██████████| 8/8 [00:01<00:00,  6.77it/s]
100%|██████████| 8/8 [00:01<00:00,  7.04it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 3/3 [00:00<00:00, 10.00it/s]
Epoch 15/15, Train Loss: 0.0691, Train R2: 0.6666, Val Loss: 0.1356, Val R2: 0.3755
Model saved as final_model.pth
Training completed and final model saved.

