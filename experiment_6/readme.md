regression with resnet 24 channels, RGB channels are scaled to imagenet
from model import load_resnet_model
model = load_resnet_model('resnet50', num_classes=1)
from train_regression import train_model
train_model(model, train_files, val_files, device, epochs=15)
100%|██████████| 8/8 [00:03<00:00,  2.63it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  2.89it/s]
100%|██████████| 8/8 [00:02<00:00,  2.87it/s]
100%|██████████| 8/8 [00:02<00:00,  2.92it/s]
100%|██████████| 8/8 [00:02<00:00,  2.82it/s]
100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.82it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.89it/s]
100%|██████████| 4/4 [00:01<00:00,  3.04it/s]
100%|██████████| 3/3 [00:00<00:00,  5.63it/s]
100%|██████████| 8/8 [00:01<00:00,  4.91it/s]
100%|██████████| 8/8 [00:01<00:00,  4.38it/s]
100%|██████████| 8/8 [00:01<00:00,  5.20it/s]
100%|██████████| 8/8 [00:01<00:00,  5.37it/s]
Epoch 1/15, Train Loss: 0.3432, Train R2: -0.7031, Val Loss: 0.1598, Val R2: 0.2087
Model saved as checkpoint_epoch_1.pth
100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
100%|██████████| 8/8 [00:02<00:00,  2.87it/s]
100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  3.04it/s]
100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
100%|██████████| 8/8 [00:02<00:00,  2.76it/s]
100%|██████████| 4/4 [00:01<00:00,  3.09it/s]
100%|██████████| 3/3 [00:00<00:00,  7.00it/s]
100%|██████████| 8/8 [00:01<00:00,  5.23it/s]
100%|██████████| 8/8 [00:01<00:00,  5.31it/s]
100%|██████████| 8/8 [00:01<00:00,  5.60it/s]
100%|██████████| 8/8 [00:01<00:00,  5.77it/s]
Epoch 2/15, Train Loss: 0.1175, Train R2: 0.4169, Val Loss: 0.1849, Val R2: 0.0845
100%|██████████| 8/8 [00:02<00:00,  3.10it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.13it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.13it/s]
100%|██████████| 8/8 [00:02<00:00,  3.09it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.05it/s]
100%|██████████| 4/4 [00:01<00:00,  3.28it/s]
100%|██████████| 3/3 [00:00<00:00,  6.73it/s]
100%|██████████| 8/8 [00:01<00:00,  5.35it/s]
100%|██████████| 8/8 [00:01<00:00,  4.87it/s]
100%|██████████| 8/8 [00:01<00:00,  5.29it/s]
100%|██████████| 8/8 [00:01<00:00,  5.69it/s]
Epoch 3/15, Train Loss: 0.1063, Train R2: 0.4726, Val Loss: 0.1442, Val R2: 0.2858
Model saved as checkpoint_epoch_3.pth
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.15it/s]
100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.10it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.15it/s]
100%|██████████| 8/8 [00:02<00:00,  3.17it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.18it/s]
100%|██████████| 4/4 [00:01<00:00,  3.28it/s]
100%|██████████| 3/3 [00:00<00:00,  7.65it/s]
100%|██████████| 8/8 [00:01<00:00,  5.53it/s]
100%|██████████| 8/8 [00:01<00:00,  5.21it/s]
100%|██████████| 8/8 [00:01<00:00,  5.44it/s]
100%|██████████| 8/8 [00:01<00:00,  5.65it/s]
Epoch 4/15, Train Loss: 0.0984, Train R2: 0.5117, Val Loss: 0.1365, Val R2: 0.3240
Model saved as checkpoint_epoch_4.pth
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.90it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 4/4 [00:01<00:00,  3.13it/s]
100%|██████████| 3/3 [00:00<00:00,  6.93it/s]
100%|██████████| 8/8 [00:01<00:00,  5.25it/s]
100%|██████████| 8/8 [00:01<00:00,  5.38it/s]
100%|██████████| 8/8 [00:01<00:00,  5.28it/s]
100%|██████████| 8/8 [00:01<00:00,  5.70it/s]
Epoch 5/15, Train Loss: 0.0944, Train R2: 0.5317, Val Loss: 0.1552, Val R2: 0.2314
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.10it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 8/8 [00:02<00:00,  3.08it/s]
100%|██████████| 8/8 [00:02<00:00,  3.10it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.08it/s]
100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
100%|██████████| 8/8 [00:02<00:00,  3.16it/s]
100%|██████████| 8/8 [00:02<00:00,  3.16it/s]
100%|██████████| 4/4 [00:01<00:00,  3.29it/s]
100%|██████████| 3/3 [00:00<00:00,  7.64it/s]
100%|██████████| 8/8 [00:01<00:00,  5.27it/s]
100%|██████████| 8/8 [00:01<00:00,  4.75it/s]
100%|██████████| 8/8 [00:01<00:00,  5.20it/s]
100%|██████████| 8/8 [00:01<00:00,  5.65it/s]
Epoch 6/15, Train Loss: 0.0905, Train R2: 0.5509, Val Loss: 0.1527, Val R2: 0.2436
100%|██████████| 8/8 [00:02<00:00,  3.09it/s]
100%|██████████| 8/8 [00:02<00:00,  2.96it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  3.04it/s]
100%|██████████| 8/8 [00:02<00:00,  2.92it/s]
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  2.96it/s]
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 4/4 [00:01<00:00,  3.19it/s]
100%|██████████| 3/3 [00:00<00:00,  6.88it/s]
100%|██████████| 8/8 [00:01<00:00,  5.52it/s]
100%|██████████| 8/8 [00:01<00:00,  4.94it/s]
100%|██████████| 8/8 [00:01<00:00,  5.60it/s]
100%|██████████| 8/8 [00:01<00:00,  5.72it/s]
Epoch 7/15, Train Loss: 0.0883, Train R2: 0.5618, Val Loss: 0.1435, Val R2: 0.2893
100%|██████████| 8/8 [00:02<00:00,  3.09it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.13it/s]
100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
100%|██████████| 8/8 [00:02<00:00,  3.10it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 8/8 [00:02<00:00,  3.16it/s]
100%|██████████| 8/8 [00:02<00:00,  3.17it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
100%|██████████| 8/8 [00:02<00:00,  3.05it/s]
100%|██████████| 4/4 [00:01<00:00,  3.27it/s]
100%|██████████| 3/3 [00:00<00:00,  7.41it/s]
100%|██████████| 8/8 [00:01<00:00,  4.95it/s]
100%|██████████| 8/8 [00:01<00:00,  5.02it/s]
100%|██████████| 8/8 [00:01<00:00,  5.12it/s]
100%|██████████| 8/8 [00:01<00:00,  5.19it/s]
Epoch 8/15, Train Loss: 0.0840, Train R2: 0.5830, Val Loss: 0.1306, Val R2: 0.3530
Model saved as checkpoint_epoch_8.pth
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  3.05it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  3.04it/s]
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 4/4 [00:01<00:00,  3.22it/s]
100%|██████████| 3/3 [00:00<00:00,  7.28it/s]
100%|██████████| 8/8 [00:01<00:00,  4.89it/s]
100%|██████████| 8/8 [00:01<00:00,  4.70it/s]
100%|██████████| 8/8 [00:01<00:00,  4.66it/s]
100%|██████████| 8/8 [00:01<00:00,  5.14it/s]
Epoch 9/15, Train Loss: 0.0795, Train R2: 0.6053, Val Loss: 0.1252, Val R2: 0.3799
Model saved as checkpoint_epoch_9.pth
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  2.90it/s]
100%|██████████| 8/8 [00:02<00:00,  2.92it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.90it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
100%|██████████| 8/8 [00:02<00:00,  3.04it/s]
100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 4/4 [00:01<00:00,  3.16it/s]
100%|██████████| 3/3 [00:00<00:00,  6.97it/s]
100%|██████████| 8/8 [00:01<00:00,  5.03it/s]
100%|██████████| 8/8 [00:01<00:00,  4.70it/s]
100%|██████████| 8/8 [00:01<00:00,  4.69it/s]
100%|██████████| 8/8 [00:01<00:00,  5.17it/s]
Epoch 10/15, Train Loss: 0.0770, Train R2: 0.6180, Val Loss: 0.1143, Val R2: 0.4337
Model saved as checkpoint_epoch_10.pth
100%|██████████| 8/8 [00:02<00:00,  2.89it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  2.96it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.88it/s]
100%|██████████| 8/8 [00:02<00:00,  2.96it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 4/4 [00:01<00:00,  3.15it/s]
100%|██████████| 3/3 [00:00<00:00,  6.70it/s]
100%|██████████| 8/8 [00:01<00:00,  4.59it/s]
100%|██████████| 8/8 [00:01<00:00,  4.65it/s]
100%|██████████| 8/8 [00:01<00:00,  4.57it/s]
100%|██████████| 8/8 [00:01<00:00,  5.14it/s]
Epoch 11/15, Train Loss: 0.0741, Train R2: 0.6323, Val Loss: 0.1441, Val R2: 0.2864
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  2.89it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  2.96it/s]
100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 4/4 [00:01<00:00,  3.14it/s]
100%|██████████| 3/3 [00:00<00:00,  6.82it/s]
100%|██████████| 8/8 [00:01<00:00,  5.28it/s]
100%|██████████| 8/8 [00:01<00:00,  5.18it/s]
100%|██████████| 8/8 [00:01<00:00,  5.31it/s]
100%|██████████| 8/8 [00:01<00:00,  5.20it/s]
Epoch 12/15, Train Loss: 0.0691, Train R2: 0.6571, Val Loss: 0.1200, Val R2: 0.4056
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.06it/s]
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  3.14it/s]
100%|██████████| 8/8 [00:02<00:00,  3.08it/s]
100%|██████████| 8/8 [00:02<00:00,  3.07it/s]
100%|██████████| 8/8 [00:02<00:00,  3.11it/s]
100%|██████████| 8/8 [00:02<00:00,  3.13it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 8/8 [00:02<00:00,  3.16it/s]
100%|██████████| 8/8 [00:02<00:00,  3.12it/s]
100%|██████████| 4/4 [00:01<00:00,  3.29it/s]
100%|██████████| 3/3 [00:00<00:00,  7.53it/s]
100%|██████████| 8/8 [00:01<00:00,  5.49it/s]
100%|██████████| 8/8 [00:01<00:00,  5.40it/s]
100%|██████████| 8/8 [00:01<00:00,  5.37it/s]
100%|██████████| 8/8 [00:01<00:00,  5.71it/s]
Epoch 13/15, Train Loss: 0.0614, Train R2: 0.6951, Val Loss: 0.2704, Val R2: -0.3388
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  2.90it/s]
100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
100%|██████████| 8/8 [00:02<00:00,  2.94it/s]
100%|██████████| 8/8 [00:02<00:00,  2.90it/s]
100%|██████████| 8/8 [00:02<00:00,  3.00it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.95it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.93it/s]
100%|██████████| 4/4 [00:01<00:00,  3.12it/s]
100%|██████████| 3/3 [00:00<00:00,  7.18it/s]
100%|██████████| 8/8 [00:01<00:00,  4.90it/s]
100%|██████████| 8/8 [00:01<00:00,  5.01it/s]
100%|██████████| 8/8 [00:01<00:00,  4.60it/s]
100%|██████████| 8/8 [00:01<00:00,  5.20it/s]
Epoch 14/15, Train Loss: 0.0592, Train R2: 0.7065, Val Loss: 0.1420, Val R2: 0.2971
100%|██████████| 8/8 [00:02<00:00,  2.96it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 8/8 [00:02<00:00,  3.03it/s]
100%|██████████| 8/8 [00:02<00:00,  2.97it/s]
100%|██████████| 8/8 [00:02<00:00,  2.99it/s]
100%|██████████| 8/8 [00:02<00:00,  3.02it/s]
100%|██████████| 8/8 [00:02<00:00,  2.91it/s]
100%|██████████| 8/8 [00:02<00:00,  3.04it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 8/8 [00:02<00:00,  2.98it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 8/8 [00:02<00:00,  3.01it/s]
100%|██████████| 4/4 [00:01<00:00,  3.20it/s]
100%|██████████| 3/3 [00:00<00:00,  6.78it/s]
100%|██████████| 8/8 [00:01<00:00,  5.32it/s]
100%|██████████| 8/8 [00:01<00:00,  5.15it/s]
100%|██████████| 8/8 [00:01<00:00,  5.30it/s]
100%|██████████| 8/8 [00:01<00:00,  5.62it/s]
Epoch 15/15, Train Loss: 0.0563, Train R2: 0.7208, Val Loss: 0.1302, Val R2: 0.3555
Model saved as final_model.pth
Training completed and final model saved.
