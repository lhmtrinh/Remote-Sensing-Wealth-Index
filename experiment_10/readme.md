regression with resnet 24 channels, RGB channels are NOT scaled to imagenet
loss function is modified to tackle imbalance structure

from model import load_resnet_model
from train_regression_weighted_loss import train_model
from weighted_MSE_loss import DenseWeight


device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = load_resnet_model('resnet50', num_classes=1)

dense_weight_model = DenseWeight(0.5)

100%|██████████| 8/8 [00:02<00:00,  2.75it/s]
100%|██████████| 8/8 [00:02<00:00,  3.42it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.61it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.61it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 4/4 [00:01<00:00,  3.63it/s]
100%|██████████| 8/8 [00:01<00:00,  7.15it/s]
100%|██████████| 8/8 [00:01<00:00,  6.98it/s]
100%|██████████| 8/8 [00:01<00:00,  7.01it/s]
100%|██████████| 8/8 [00:01<00:00,  7.22it/s]
100%|██████████| 3/3 [00:00<00:00,  7.67it/s]
Epoch 1/15, Train Loss: 0.2852, Train R2: -0.3604, Val Loss: 0.1158, Val R2: 0.4857
Model saved as checkpoint_epoch_1.pth
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 4/4 [00:01<00:00,  3.73it/s]
100%|██████████| 8/8 [00:01<00:00,  7.19it/s]
100%|██████████| 8/8 [00:01<00:00,  7.22it/s]
100%|██████████| 8/8 [00:01<00:00,  7.17it/s]
100%|██████████| 8/8 [00:01<00:00,  7.22it/s]
100%|██████████| 3/3 [00:00<00:00,  9.91it/s]
Epoch 2/15, Train Loss: 0.1195, Train R2: 0.4476, Val Loss: 0.1151, Val R2: 0.5072
Model saved as checkpoint_epoch_2.pth
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.60it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 4/4 [00:01<00:00,  3.72it/s]
100%|██████████| 8/8 [00:01<00:00,  7.21it/s]
100%|██████████| 8/8 [00:01<00:00,  7.15it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  6.89it/s]
100%|██████████| 3/3 [00:00<00:00,  9.96it/s]
Epoch 3/15, Train Loss: 0.1112, Train R2: 0.4831, Val Loss: 0.1190, Val R2: 0.5086
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 4/4 [00:01<00:00,  3.72it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  6.91it/s]
100%|██████████| 8/8 [00:01<00:00,  6.86it/s]
100%|██████████| 8/8 [00:01<00:00,  6.67it/s]
100%|██████████| 3/3 [00:00<00:00,  9.98it/s]
Epoch 4/15, Train Loss: 0.1009, Train R2: 0.5296, Val Loss: 0.1079, Val R2: 0.5374
Model saved as checkpoint_epoch_4.pth
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.55it/s]
100%|██████████| 4/4 [00:01<00:00,  3.70it/s]
100%|██████████| 8/8 [00:01<00:00,  7.14it/s]
100%|██████████| 8/8 [00:01<00:00,  6.84it/s]
100%|██████████| 8/8 [00:01<00:00,  7.11it/s]
100%|██████████| 8/8 [00:01<00:00,  6.86it/s]
100%|██████████| 3/3 [00:00<00:00,  9.94it/s]
Epoch 5/15, Train Loss: 0.0902, Train R2: 0.5785, Val Loss: 0.1418, Val R2: 0.4051
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.59it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.71it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  6.80it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  6.90it/s]
100%|██████████| 3/3 [00:00<00:00,  9.87it/s]
Epoch 6/15, Train Loss: 0.0844, Train R2: 0.6020, Val Loss: 0.1260, Val R2: 0.4697
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.54it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 4/4 [00:01<00:00,  3.72it/s]
100%|██████████| 8/8 [00:01<00:00,  7.12it/s]
100%|██████████| 8/8 [00:01<00:00,  6.70it/s]
100%|██████████| 8/8 [00:01<00:00,  7.08it/s]
100%|██████████| 8/8 [00:01<00:00,  7.12it/s]
100%|██████████| 3/3 [00:00<00:00, 10.11it/s]
Epoch 7/15, Train Loss: 0.0735, Train R2: 0.6530, Val Loss: 0.1397, Val R2: 0.4008
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.47it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  7.11it/s]
100%|██████████| 8/8 [00:01<00:00,  6.68it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  7.05it/s]
100%|██████████| 3/3 [00:00<00:00,  9.88it/s]
Epoch 8/15, Train Loss: 0.0671, Train R2: 0.6822, Val Loss: 0.1337, Val R2: 0.4318
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  7.09it/s]
100%|██████████| 8/8 [00:01<00:00,  6.31it/s]
100%|██████████| 8/8 [00:01<00:00,  6.68it/s]
100%|██████████| 8/8 [00:01<00:00,  6.85it/s]
100%|██████████| 3/3 [00:00<00:00,  9.89it/s]
Epoch 9/15, Train Loss: 0.0758, Train R2: 0.6407, Val Loss: 0.1550, Val R2: 0.3532
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.52it/s]
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  7.10it/s]
100%|██████████| 8/8 [00:01<00:00,  6.46it/s]
100%|██████████| 8/8 [00:01<00:00,  6.85it/s]
100%|██████████| 8/8 [00:01<00:00,  6.82it/s]
100%|██████████| 3/3 [00:00<00:00,  9.95it/s]
Epoch 10/15, Train Loss: 0.0694, Train R2: 0.6709, Val Loss: 0.1220, Val R2: 0.4494
100%|██████████| 8/8 [00:02<00:00,  3.49it/s]
100%|██████████| 8/8 [00:02<00:00,  3.44it/s]
100%|██████████| 8/8 [00:02<00:00,  3.48it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.57it/s]
100%|██████████| 8/8 [00:02<00:00,  3.58it/s]
100%|██████████| 8/8 [00:02<00:00,  3.53it/s]
100%|██████████| 8/8 [00:02<00:00,  3.51it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 8/8 [00:02<00:00,  3.50it/s]
100%|██████████| 4/4 [00:01<00:00,  3.69it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  6.27it/s]
100%|██████████| 8/8 [00:01<00:00,  7.07it/s]
100%|██████████| 8/8 [00:01<00:00,  6.97it/s]
100%|██████████| 3/3 [00:00<00:00, 10.04it/s]
Epoch 11/15, Train Loss: 0.0581, Train R2: 0.7205, Val Loss: 0.1206, Val R2: 0.4455
100%|██████████| 8/8 [00:02<00:00,  3.56it/s]


