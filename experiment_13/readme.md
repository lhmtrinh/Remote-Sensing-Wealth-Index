regression with resnet 24 channels, RGB channels are NOT scaled to imagenet
loss function is modified to tackle imbalance structure
Use L3 Loss L1*L2*weight
lr=0.0001

from model import load_resnet_model
from train_regression_weighted_loss import train_model
from weighted_MSE_loss import DenseWeight


device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
model = load_resnet_model('resnet50', num_classes=1)

dense_weight_model = DenseWeight(0.2)

100%|██████████| 8/8 [00:03<00:00,  2.11it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 8/8 [00:01<00:00,  6.51it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 8/8 [00:01<00:00,  6.52it/s]
100%|██████████| 8/8 [00:01<00:00,  6.52it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 8/8 [00:01<00:00,  6.51it/s]
100%|██████████| 8/8 [00:01<00:00,  6.54it/s]
100%|██████████| 8/8 [00:01<00:00,  6.53it/s]
100%|██████████| 4/4 [00:00<00:00,  5.00it/s]
100%|██████████| 8/8 [00:00<00:00, 12.89it/s]
100%|██████████| 8/8 [00:00<00:00, 12.98it/s]
100%|██████████| 8/8 [00:00<00:00, 13.05it/s]
100%|██████████| 8/8 [00:00<00:00, 13.03it/s]
100%|██████████| 3/3 [00:00<00:00, 10.83it/s]
Epoch 1/15, Train Loss: 0.3614, Train R2: -0.3714, Val Loss: 0.0766, Val R2: 0.4260
Model saved as checkpoint_epoch_1.pth
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 8/8 [00:00<00:00, 13.31it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.35it/s]
100%|██████████| 3/3 [00:00<00:00, 18.31it/s]
Epoch 2/15, Train Loss: 0.0728, Train R2: 0.4015, Val Loss: 0.0727, Val R2: 0.4631
Model saved as checkpoint_epoch_2.pth
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
100%|██████████| 8/8 [00:00<00:00, 13.33it/s]
100%|██████████| 8/8 [00:00<00:00, 13.38it/s]
100%|██████████| 8/8 [00:00<00:00, 13.35it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 3/3 [00:00<00:00, 18.39it/s]
Epoch 3/15, Train Loss: 0.0618, Train R2: 0.4631, Val Loss: 0.0567, Val R2: 0.5132
Model saved as checkpoint_epoch_3.pth
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 8/8 [00:00<00:00, 13.33it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 8/8 [00:00<00:00, 13.32it/s]
100%|██████████| 8/8 [00:00<00:00, 13.38it/s]
100%|██████████| 3/3 [00:00<00:00, 18.15it/s]
Epoch 4/15, Train Loss: 0.0528, Train R2: 0.5146, Val Loss: 0.0731, Val R2: 0.4521
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.31it/s]
100%|██████████| 8/8 [00:00<00:00, 13.25it/s]
100%|██████████| 3/3 [00:00<00:00, 18.35it/s]
Epoch 5/15, Train Loss: 0.0448, Train R2: 0.5611, Val Loss: 0.0604, Val R2: 0.5121
100%|██████████| 8/8 [00:01<00:00,  6.59it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.38it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 3/3 [00:00<00:00, 18.41it/s]
Epoch 6/15, Train Loss: 0.0369, Train R2: 0.6071, Val Loss: 0.0740, Val R2: 0.4489
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 3/3 [00:00<00:00, 18.31it/s]
Epoch 7/15, Train Loss: 0.0297, Train R2: 0.6546, Val Loss: 0.0875, Val R2: 0.3910
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 8/8 [00:00<00:00, 13.38it/s]
100%|██████████| 8/8 [00:00<00:00, 13.39it/s]
100%|██████████| 8/8 [00:00<00:00, 13.39it/s]
100%|██████████| 8/8 [00:00<00:00, 13.40it/s]
100%|██████████| 3/3 [00:00<00:00, 18.43it/s]
Epoch 8/15, Train Loss: 0.0287, Train R2: 0.6650, Val Loss: 0.1239, Val R2: 0.2400
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 8/8 [00:00<00:00, 13.32it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 8/8 [00:00<00:00, 13.32it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 3/3 [00:00<00:00, 18.32it/s]
Epoch 9/15, Train Loss: 0.0256, Train R2: 0.6925, Val Loss: 0.0635, Val R2: 0.4881
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.59it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.78it/s]
100%|██████████| 8/8 [00:00<00:00, 13.29it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.38it/s]
100%|██████████| 8/8 [00:00<00:00, 13.32it/s]
100%|██████████| 3/3 [00:00<00:00, 17.47it/s]
Epoch 10/15, Train Loss: 0.0209, Train R2: 0.7313, Val Loss: 0.0644, Val R2: 0.4936
100%|██████████| 8/8 [00:01<00:00,  6.60it/s]
100%|██████████| 8/8 [00:01<00:00,  6.60it/s]
100%|██████████| 8/8 [00:01<00:00,  6.59it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 8/8 [00:00<00:00, 13.35it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 3/3 [00:00<00:00, 18.37it/s]
Epoch 11/15, Train Loss: 0.0150, Train R2: 0.7849, Val Loss: 0.0626, Val R2: 0.4823
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.64it/s]
100%|██████████| 8/8 [00:01<00:00,  6.60it/s]
100%|██████████| 8/8 [00:01<00:00,  6.65it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 4/4 [00:00<00:00,  6.79it/s]
100%|██████████| 8/8 [00:00<00:00, 13.35it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 8/8 [00:00<00:00, 13.35it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 3/3 [00:00<00:00, 18.21it/s]
Epoch 12/15, Train Loss: 0.0148, Train R2: 0.7874, Val Loss: 0.0579, Val R2: 0.5089
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.60it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.76it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 8/8 [00:00<00:00, 13.37it/s]
100%|██████████| 3/3 [00:00<00:00, 18.38it/s]
Epoch 13/15, Train Loss: 0.0142, Train R2: 0.7976, Val Loss: 0.0969, Val R2: 0.3544
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
100%|██████████| 8/8 [00:00<00:00, 13.33it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 8/8 [00:00<00:00, 13.26it/s]
100%|██████████| 8/8 [00:00<00:00, 13.34it/s]
100%|██████████| 3/3 [00:00<00:00, 18.36it/s]
Epoch 14/15, Train Loss: 0.0128, Train R2: 0.8117, Val Loss: 0.0605, Val R2: 0.5136
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.61it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.60it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.62it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 8/8 [00:01<00:00,  6.63it/s]
100%|██████████| 4/4 [00:00<00:00,  6.77it/s]
100%|██████████| 8/8 [00:00<00:00, 13.26it/s]
100%|██████████| 8/8 [00:00<00:00, 13.32it/s]
100%|██████████| 8/8 [00:00<00:00, 13.33it/s]
100%|██████████| 8/8 [00:00<00:00, 13.36it/s]
100%|██████████| 3/3 [00:00<00:00, 18.41it/s]
Epoch 15/15, Train Loss: 0.0112, Train R2: 0.8243, Val Loss: 0.1214, Val R2: 0.0852
Model saved as final_model.pth
Training completed and final model saved.
